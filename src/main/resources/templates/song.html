<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>곡 상세</title>
  <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>
<!-- 홈으로 가는 버튼 -->
<a href="/" class="home-button">홈으로</a>

<h2>곡 상세 정보</h2>
<table>
  <tr>
    <th>곡 ID</th>
    <td th:text="${song.songId}"></td>
  </tr>
  <tr>
    <th>곡명</th>
    <td th:text="${song.songName}"></td>
  </tr>
  <tr>
    <th>장르</th>
    <td th:text="${song.songGenre}"></td>
  </tr>
  <tr>
    <th>길이</th>
    <td th:text="${song.songLength}"></td>
  </tr>
  <tr>
    <th>아티스트</th>
    <td th:text="${song.artist}"></td>
  </tr>
  <tr>
    <th>가사</th>
    <td>
      <pre th:text="${song.songLyrics}"></pre>
    </td>
  </tr>
  <tr>
    <th>앨범 ID</th>
    <td>
      <!-- 앨범 ID 클릭 시 앨범 정보로 이동 -->
      <a th:href="@{/album/{albumId}(albumId=${song.songAlbumId})}" th:text="${song.songAlbumId}"></a>
    </td>
  </tr>
</table>

<!-- 수정하기 버튼 -->
<button id="editButton" onclick="toggleEditForm()">수정하기</button>

<!-- 수정 폼, initially hidden -->
<div id="editForm" style="display: none;">
  <form th:action="@{/song/update/{songId}(songId=${song.songId})}" method="POST">
    <label for="songName">곡명:</label>
    <input type="text" id="songName" name="songName" th:value="${song.songName}" required /><br>
    <label for="songGenre">장르:</label>
    <input type="text" id="songGenre" name="songGenre" th:value="${song.songGenre}" required /><br>
    <label for="songLength">길이:</label>
    <input type="text" id="songLength" name="songLength" th:value="${song.songLength}" required /><br>
    <label for="artist">아티스트:</label>
    <input type="text" id="artist" name="artist" th:value="${song.artist}" required /><br>
    <label for="songLyrics">가사:</label><br>
    <textarea id="songLyrics" name="songLyrics" rows="4" cols="50" th:text="${song.songLyrics}" required></textarea><br>
    <!-- songAlbumId는 수정하지 않음, 기존 값 그대로 사용 -->
    <input type="hidden" id="songAlbumId" name="songAlbumId" th:value="${song.songAlbumId}" />
    <button type="submit">수정 완료</button>
    <button type="button" onclick="toggleEditForm()">수정 취소</button>
  </form>
</div>

<!-- 곡 삭제하기 폼 -->
<form th:action="@{/song/delete/{songId}(songId=${song.songId})}" method="POST" id="deleteForm" style="display: inline;">
  <button type="submit" id="deleteButton" onclick="return confirmDelete()">곡 삭제하기</button>
</form>

<a href="/song">곡 목록으로</a>

<!-- JavaScript to toggle edit form visibility -->
<script>
  function toggleEditForm() {
    var editForm = document.getElementById("editForm");
    var editButton = document.getElementById("editButton");
    if (editForm.style.display === "none") {
      editForm.style.display = "block";
      editButton.style.display = "none";
    } else {
      editForm.style.display = "none";
      editButton.style.display = "inline-block";
    }
  }

  function confirmDelete() {
    // 사용자가 삭제를 확인하면 삭제 요청
    var isConfirmed = confirm("정말로 삭제하시겠습니까?");
    return isConfirmed;  // true이면 폼이 제출됨
  }
</script>
</body>
</html>