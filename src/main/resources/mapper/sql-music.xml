<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.springmusic.mapper.MusicMapper">

    <select id="selectAlbumList" resultType="com.springmusic.dto.AlbumDto">
        select album_id, album_name, title_song, track_number, genre, release_date, artist
        from album
        order by album_id desc
    </select>

    <select id="selectAlbum" parameterType="int" resultType="com.springmusic.dto.AlbumDto">
        select album_id, album_name, title_song, track_number, genre, release_date, artist
        from album
        where album_id = #{albumId}
    </select>

    <select id="selectAlbumSongs" parameterType="int" resultType="com.springmusic.dto.SongDto">
        select song_id, song_name, song_lyrics, song_genre, song_length, song_track_number, song_album_id, artist
        from song
        where song_album_id = #{songAlbumId}
        order by song_track_number
    </select>

    <delete id="deleteAlbum" parameterType="int">
        delete from album
        where album_id = #{albumId}
    </delete>

    <delete id="deleteAlbumSongs" parameterType="int">
        delete from song
        where album_id = #{albumId}
    </delete>

    <delete id="deleteSong" parameterType="int">
        delete from song
        where song_id = #{songId}
    </delete>

    <insert id="insertAlbum" parameterType="com.springmusic.dto.AlbumDto"
        useGeneratedKeys="true" keyProperty="albumId">
        insert into album (album_name, title_song, track_number, genre, release_date, artist)
        values (#{albumName}, #{titleSong}, #{trackNumber}, #{genre}, #{releaseDate}, #{artist})
    </insert>

    <insert id="insertSong" parameterType="com.springmusic.dto.SongDto"
            useGeneratedKeys="true" keyProperty="songId">
        INSERT INTO song (song_name, song_lyrics, song_genre, song_length, song_track_number, song_album_id, artist)
        VALUES (#{songName}, #{songLyrics}, #{songGenre}, #{songLength}, #{songTrackNumber}, #{songAlbumId}, #{artist})
    </insert>

    <select id="selectSong" parameterType="int" resultType="com.springmusic.dto.SongDto">
        select song_id, song_name, song_lyrics, song_genre, song_length, song_track_number, song_album_id, artist
        from song
        where song_id = #{songId}
    </select>

    <select id="selectSongList" resultType="com.springmusic.dto.SongDto">
        select song_id, song_name, song_lyrics, song_genre, song_length, song_track_number, song_album_id, artist
        from song
        order by song_id desc
    </select>

    <update id="updateAlbum" parameterType="com.springmusic.dto.AlbumDto">
        update album
        set album_name = #{albumName},
            title_song = #{titleSong},
            track_number = #{trackNumber},
            genre = #{genre},
            release_date = #{releaseDate},
            artist = #{artist}
        where album_id = #{albumId}
    </update>

    <update id="updateSong" parameterType="com.springmusic.dto.SongDto">
        update song
        set song_name = #{songName},
            song_lyrics = #{songLyrics},
            song_genre = #{songGenre},
            song_length = #{songLength},
            song_track_number = #{songTrackNumber},
            song_album_id = #{songAlbumId},
            artist = #{artist}
        where song_id = #{songId}
    </update>

</mapper>